@using Microsoft.AspNetCore.Http
@using Newtonsoft.Json
@using NSIE.Models
@inject IHttpContextAccessor HttpContextAccessor

@{
    var httpContext = HttpContextAccessor.HttpContext;
    var perfilUsuarioJson = httpContext.Session.GetString("PerfilUsuario");
    var perfilUsuario = JsonConvert.DeserializeObject<PerfilUsuario>(perfilUsuarioJson);
    // Utilizar los datos del usuario para personalizar la vista
    ViewData["NombreUsuario"] = perfilUsuario.Nombre;
    ViewData["RolUsuario"] = perfilUsuario.Rol;
}

@{
    ViewData["Title"] = "Certificados de Energías Limpias - CEL";
    var totalCelOtorgados = 144488009;
}



@{
    var header = new HeaderViewModel
    {
        Title = "Certificados de Energías Limpias (CEL)",
        IconPath = "energia-limpia.png",
        Description = "Sistema de monitoreo y consulta de Certificados de Energía Limpia.",
        Section = "🌿 Energías Limpias",
        ModuleInfo = JsonConvert.SerializeObject(new
        {
            title = "Certificados de Energías Limpias",
            description = "Plataforma de seguimiento y consulta de CEL.",
            functionality = "Permite visualizar estadísticas, participantes y regulación de CEL.",
            stage = "Monitoreo CEL",
            roles = new[] {
                new { icon = "building", text = "CRE: Regulación y control" },
                new { icon = "check-circle", text = "Generadores: Seguimiento" },
                new { icon = "search", text = "Público: Consulta" }
            },
            order = new { step = 1, description = "Consulta de CEL y participantes" }
        })
    };
}

@await Html.PartialAsync("_ViewHeader", header)


<div class="container ps-5 pe-5">

    <!-- Banner mejorado con AOS -->
    <div class="text-center" data-aos="zoom-in" data-aos-duration="1000">
        <img src="~/img/banner/12.png" alt="Certificados de Energías Limpias" class="img-fluid shadow-lg rounded" 
             style="max-width: 100%; height: auto; margin-bottom: 20px;">
    </div>

    <!-- Tarjeta de total histórico mejorada -->
    <div data-aos="flip-up" data-aos-duration="1200">
        <div class="card text-white mb-4" style="background-color: #006769;">
            <div class="card-body text-center">
                <h4 class="card-title text-white" data-aos="fade-down" data-aos-delay="200">
                    <i class="bi bi-award-fill me-2"></i>Total Histórico de CEL Otorgados
                </h4>
                <p class="card-text display-4" data-aos="zoom-in" data-aos-delay="400">
                    @string.Format("{0:N0}", totalCelOtorgados)
                </p>
            </div>
        </div>
    </div>

    <!-- Gráfico con animación -->
    <div class="card shadow-sm border-0 mb-4" data-aos="fade-up" data-aos-duration="1000">
        <div class="card-body">
            <div id="grafico-cel" style="width:100%; height:700px;"></div>
        </div>
    </div>

    <!-- Tabla con efecto de entrada -->
    <div class="table-responsive pb-3" data-aos="fade-up" data-aos-delay="200">
        <table id="tabla-cel" class="display table table-hover table-responsive table-bordered">
            <thead>
                <tr>
                    <th>Mes/Año</th>
                    <th>2018</th>
                    <th>2019</th>
                    <th>2020</th>
                    <th>2021</th>
                    <th>2022</th>
                    <th>2023</th>
                    <th>2024</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>ENERO</td>
                    <td>538,572</td>
                    <td>648,446</td>
                    <td>1,530,651</td>
                    <td>1,705,445</td>
                    <td>1,680,120</td>
                    <td>2,165,115</td>
                    <td>1,904,200</td>
                </tr>
                <tr>
                    <td>FEBRERO</td>
                    <td>427,233</td>
                    <td>669,909</td>
                    <td>1,708,950</td>
                    <td>1,887,234</td>
                    <td>1,812,744</td>
                    <td>2,191,107</td>
                    <td>2,198,405</td>
                </tr>
                <tr>
                    <td>MARZO</td>
                    <td>532,939</td>
                    <td>1,097,669</td>
                    <td>2,051,673</td>
                    <td>2,611,467</td>
                    <td>2,404,781</td>
                    <td>2,715,207</td>
                    <td>2,323,209</td>
                </tr>
                <tr>
                    <td>ABRIL</td>
                    <td>549,051</td>
                    <td>1,049,868</td>
                    <td>1,999,103</td>
                    <td>2,507,151</td>
                    <td>2,124,862</td>
                    <td>2,509,695</td>
                    <td>2,537,756</td>
                </tr>
                <tr>
                    <td>MAYO</td>
                    <td>674,984</td>
                    <td>1,231,452</td>
                    <td>1,958,300</td>
                    <td>2,739,825</td>
                    <td>2,412,403</td>
                    <td>2,467,700</td>
                    <td>2,754,979</td>
                </tr>
                <tr>
                    <td>JUNIO</td>
                    <td>526,698</td>
                    <td>1,316,380</td>
                    <td>1,932,990</td>
                    <td>2,303,208</td>
                    <td>2,421,500</td>
                    <td>2,720,630</td>
                    <td>2,637,287</td>
                </tr>
                <tr>
                    <td>JULIO</td>
                    <td>1,033,073</td>
                    <td>1,482,776</td>
                    <td>2,152,132</td>
                    <td>2,339,402</td>
                    <td>2,522,640</td>
                    <td>2,800,282</td>
                    <td>2,285,926</td>
                </tr>
                <tr>
                    <td>AGOSTO</td>
                    <td>1,000,856</td>
                    <td>1,472,416</td>
                    <td>1,789,495</td>
                    <td>2,523,167</td>
                    <td>2,230,620</td>
                    <td>2,514,207</td>
                    <td style="color: red; font-weight: bold;">2,618,979</td>
                </tr>
                <tr>
                    <td>SEPTIEMBRE</td>
                    <td>1,157,196</td>
                    <td>1,376,814</td>
                    <td>1,686,139</td>
                    <td>2,169,083</td>
                    <td>1,601,547</td>
                    <td>2,196,668</td>
                    <td>---</td>
                </tr>
                <tr>
                    <td>OCTUBRE</td>
                    <td>880,678</td>
                    <td>1,521,601</td>
                    <td>2,040,108</td>
                    <td>2,051,384</td>
                    <td>1,674,428</td>
                    <td>1,947,998</td>
                    <td>---</td>
                </tr>
                <tr>
                    <td>NOVIEMBRE</td>
                    <td>743,355</td>
                    <td>1,335,226</td>
                    <td>1,693,438</td>
                    <td>2,081,518</td>
                    <td>1,730,790</td>
                    <td>1,680,727</td>
                    <td>---</td>
                </tr>
                <tr>
                    <td>DICIEMBRE</td>
                    <td>850,942</td>
                    <td>1,394,589</td>
                    <td>1,752,448</td>
                    <td>2,126,698</td>
                    <td>2,017,990</td>
                    <td>1,830,775</td>
                    <td>---</td>
                </tr>
            </tbody>
            <tfoot>
                <tr>
                    <th>Total</th>
                    <th>8,915,577</th>
                    <th>14,597,146</th>
                    <th>22,295,427</th>
                    <th>27,045,582</th>
                    <th>24,634,425</th>
                    <th>27,740,111</th>
                    <th>19,260,741</th>
                </tr>
            </tfoot>

        </table>
    </div>
    <div class="alert alert-warning mt-4" role="alert">
        <strong>Notas:</strong>
        <hr>
        <ul>
            <li>Cifras sujetas a revisiones periódicas.</li>
            <li>Se incluyen las asignaciones de CEL de los nuevos participantes que obtienen su registro en el S-CEL.
            </li>
        </ul>
    </div>

    <div class="alert alert-success" role="alert">
        <ul>
            <li>Los datos corresponden al corte del 19 de julio de 2024, con los ajustes solicitados por los
                Participantes.</li>
            <li>El otorgamiento de CEL se realiza a mes vencido, datos de generación de junio de 2024.</li>
        </ul>
    </div>





    <br>
    <h2 class="subtitulo mb-3">Generadores Limpios en el Periodo de Otorgamiento</h2>
    <div class="table-responsive pb-3" data-aos="fade-up" data-aos-delay="200">
        <table id="tabla-genl" class="display table table-hover table-responsive table-bordered">
            <thead>
                <tr>
                    <th>Generador Limpio</th>
                    <th>Correo Electrónico</th>
                </tr>
            </thead>
            <tbody>
             <tr><td>174 PG Torreón, S. de R.L. de C.V.</td><td class="email">lhernandeze@mpa.mx</td></tr>
    <tr><td>AE MEX Global, S. de R.L. de C.V.</td><td class="email">armarquez@acciona.com</td></tr>
    <tr><td>Ahumada IV Solar PV, S.A. de C.V.</td><td class="email">asantillan@ampper.com</td></tr>
    <tr><td>AT Solar V, S. de R.L. de C.V.</td><td class="email">atsolarv@acciona.com</td></tr>
    <tr><td>Avant Energías Renovables I, S.A.P.I. de C.V.</td><td class="email">despinos@abalandfund.com</td></tr>
    <tr><td>B-Energy Industries, S.A. de C.V.</td><td class="email">bleon@bafar.com.mx</td></tr>
    <tr><td>Bio Pappel Scribe, S.A. de C.V.</td><td class="email">adrianamartinez@biopappel.com</td></tr>
    <tr><td>Bluemex Power 1, S.A. de C.V.</td><td class="email">vilma.trujillo@edf-re.com</td></tr>
    <tr><td>BNB Villa Ahumada Solar, S. de R.L. de C.V.</td><td class="email">omar.martinez@engie.com</td></tr>
    <tr><td>Buenos Días Energía, S. de R.L. de C.V.</td><td class="email">juan.medina@engie.com</td></tr>
    <tr><td>CE G Sanbons, S.A. de C.V.</td><td class="email">gestionescels@gmail.com</td></tr>
    <tr><td>CE G Sanbons, S.A. de C.V., Central Vallejo</td><td class="email">gestionescelsvallejo@gmail.com</td></tr>
    <tr><td>Celulosa de Fibras Mexicanas, S.A. de C.V.</td><td class="email">dzamarripa@seisaenergia.com</td></tr>
    <tr><td>Central La Mata Fase II</td><td class="email">hugo.rodriguez09@cfe.gob.mx</td></tr>
    <tr><td>Central Laguna Verde</td><td class="email">jorge.ruiz@cfe.mx</td></tr>
    <tr><td>Central Los Azufres</td><td class="email">elias.barrazan@cfe.mx</td></tr>
    <tr><td>Central Los Humores</td><td class="email">jorge.ruiz01@cfe.gob.mx</td></tr>
    <tr><td>Central Progreso, S.A de C.V.</td><td class="email">lafeve@hotmail.com</td></tr>
    <tr><td>CFE Generación III: Peñasco</td><td class="email">juan.rojas@cfe.mx</td></tr>
    <tr><td>Comercializadora de Lácteos y Derivados, S.A. de C.V.</td><td class="email">hector.flores@grupolala.com</td></tr>
    <tr><td>Compañía Cervecera de Coahuila, S. de R.L. de C.V.</td><td class="email">sergio.caldera@cbrands.com</td></tr>
    <tr><td>CuBico Alten Aguascalientes Dos, S.A.P.I. de C.V.</td><td class="email">memsolem2@alten-energy.com</td></tr>
    <tr><td>CuBico Alten Aguascalientes Uno, S.A.P.I. de C.V.</td><td class="email">memsolem1@alten-energy.com</td></tr>
    <tr><td>Dolores Wind, S.A. de C.V.</td><td class="email">susana.alcaraz@enel.com</td></tr>
    <tr><td>EGP Magdalena Solar, S.A. de C.V.</td><td class="email">Irene.Diaz@enel.com</td></tr>
    <tr><td>Elan Energy Generadora Dos, S.A.P.I. de C.V.</td><td class="email">htorresa@elanenenergy.com</td></tr>
    <tr><td>Energía Eléctrica de Chihuahua, S.A. de C.V.</td><td class="email">pizoteco@ammer.com</td></tr>
    <tr><td>Energía Renovable de la Península, S.A.P.I. de C.V.</td><td class="email">erdp@viveenergia.com</td></tr>
    <tr><td>Energía Renovable del Istmo II, S.A. de C.V.</td><td class="email">acastro2@acciona.es</td></tr>
    <tr><td>Energía Sierra Juárez Holding, S. de R.L. de C.V.</td><td class="email">operaciones.men@ienova.com.mx</td></tr>
    <tr><td>Energia Solar de Poniente, S. de R.L. de C.V.</td><td class="email">asalade@opdenergy.com</td></tr>
    <tr><td>Energía Solar San Ignacio, S. de R.L. de C.V.</td><td class="email">daniel.rodriguez@whitesummitcap.com</td></tr>
    <tr><td>Energía Solar Sonorense, S.A. de C.V.</td><td class="email">mgomezasa@ammer.com</td></tr>
    <tr><td>Energías Renovables Venta III, S.A. de C.V.</td><td class="email">lcasilias@iberdrola.com</td></tr>
    <tr><td>Energreen Energía PI, S.A. de C.V.</td><td class="email">sramirez@energreen.com.mx</td></tr>
    <tr><td>Engie Abril PV, S. de R.L. de C.V.</td><td class="email">jimmy.aranibar@engie.com</td></tr>
    <tr><td>Engie Eólica Tres Mesas 3, S.A. de C.V.</td><td class="email">rafael.torres@engie.com</td></tr>
    <tr><td>ERN AGS, S.A. de C.V.</td><td class="email">lionel.bony@neoen.com</td></tr>
    <tr><td>Eólica Coromuel, S. de R.L. de C.V.</td><td class="email">scel@eurusenergy.com</td></tr>
    <tr><td>Eólica Mesa La Paz, S. de R.L. de C.V.</td><td class="email">francisco.castaneda@aes.com</td></tr>
    <tr><td>Eólica Tres Mesas 4, S. de R.L. de C.V.</td><td class="email">eduardo.navarez@enie.com</td></tr>

        <tr><td>ESJ Renovable I, S. de R.L. de C.V.</td><td class="email">tdmcompro@ienova.com.mx</td></tr>
    <tr><td>ESJ Renovable II, S. de R.L. de C.V.</td><td class="email">power@ienova.com.mx</td></tr>
    <tr><td>Fisterra Energy Orejana, S. de R.L. de C.V.</td><td class="email">kamet@zumaenergia.com</td></tr>
    <tr><td>Fisterra Energy Santa María I, S.A.P.I. de C.V.</td><td class="email">quetzal@zumaenergia.com</td></tr>
    <tr><td>Fortius Electromecánica, S.A. de C.V.</td><td class="email">p.baroutsos@fortius.com.mx</td></tr>
    <tr><td>Fotovoltaica de Ahumada, S.A. de C.V.</td><td class="email">gcedillo@ampmer.com</td></tr>
    <tr><td>FRV Potosí Solar, S. de R.L. de C.V.</td><td class="email">fernando.salinas@frv.com</td></tr>
    <tr><td>FRV Potrero Solar, S. de R.L. de C.V.</td><td class="email">montserrat.munoz@frv.com</td></tr>
    <tr><td>Fuerza y Energía Limpia de Tizimín, S.A de C.V.</td><td class="email">jdelarosa@alarde.mx</td></tr>
    <tr><td>FV Mexsolar I, S.A.P.I. de C.V.</td><td class="email">celsmexsolar1@x-elio.com</td></tr>
    <tr><td>FV Mexsolar II, S.A.P.I. de C.V.</td><td class="email">celsmexsolar2@x-elio.com</td></tr>
    <tr><td>FV Mexsolar XI, S.A.P.I. de C.V.</td><td class="email">celsperote@x-elio.com</td></tr>
    <tr><td>Generadora Fénix, S.A.P.I. de C.V.</td><td class="email">rui.desousa@fenixenergia.com.mx</td></tr>
    <tr><td>Generadora Fénix, S.A.P.I. de C.V., Central Lerma 3</td><td class="email">ler-u3@fenixenergia.com.mx</td></tr>
    <tr><td>Generadora Fénix, S.A.P.I. de C.V., Central Necaxa 1</td><td class="email">nec-u2@fenixenergia.com.mx</td></tr>
    <tr><td>Generadora Fénix, S.A.P.I. de C.V., Central Necaxa 2</td><td class="email">nec-u1@fenixenergia.com.mx</td></tr>
    <tr><td>Generadora Fénix, S.A.P.I. de C.V., Central Necaxa 10</td><td class="email">nec-u10@fenixenergia.com.mx</td></tr>
    <tr><td>Generadora Fénix, S.A.P.I. de C.V., Central Necaxa 3</td><td class="email">nec-u3@fenixenergia.com.mx</td></tr>
    <tr><td>Generadora Fénix, S.A.P.I. de C.V., Central Necaxa 4</td><td class="email">nec-u4@fenixenergia.com.mx</td></tr>
    <tr><td>Generadora Fénix, S.A.P.I. de C.V., Central Necaxa 5</td><td class="email">nec-u5@fenixenergia.com.mx</td></tr>
    <tr><td>Generadora Fénix, S.A.P.I. de C.V., Central Necaxa 7</td><td class="email">nec-u7@fenixenergia.com.mx</td></tr>
    <tr><td>Generadora Fénix, S.A.P.I. de C.V., Central Necaxa 8</td><td class="email">nec-u8@fenixenergia.com.mx</td></tr>
    <tr><td>Generadora Fénix, S.A.P.I. de C.V., Central Patla</td><td class="email">ptl-u1@fenixenergia.com.mx</td></tr>
    <tr><td>Generadora Fénix, S.A.P.I. de C.V., Central Patla 2</td><td class="email">ptl-u3@fenixenergia.com.mx</td></tr>
    <tr><td>Generadora Fénix, S.A.P.I. de C.V., Central Patla 3</td><td class="email">ptl-u3of@fenixenergia.com.mx</td></tr>
    <tr><td>Generadora Fénix, S.A.P.I. de C.V., Central Tepexic</td><td class="email">tep-u1@fenixenergia.com.mx</td></tr>
    <tr><td>Generadora Fénix, S.A.P.I. de C.V., Central Tepexic 2</td><td class="email">tep-u2@fenixenergia.com.mx</td></tr>
    <tr><td>Generadora Fénix, S.A.P.I. de C.V., Central Tepexic 3</td><td class="email">tep-u3@fenixenergia.com.mx</td></tr>
    <tr><td>Generadora Fénix, S.A.P.I. de C.V., Temascaltepec</td><td class="email">tet@fenixenergia.com.mx</td></tr>
    <tr><td>Giavudan de México, S.A. de C.V.</td><td class="email">bernardo.maldonado@giavudan.com</td></tr>
    <tr><td>Granjas Carroll de México, S. de R.L. de C.V., Central Perote</td><td class="email">naizet.landa@gmail.com</td></tr>
    <tr><td>Granjas Carroll de México, S. de R.L. de C.V., Central Cuyoaco</td><td class="email">izavala@ecomtrading.com</td></tr>
    <tr><td>Green Hub, S.A. de C.V.</td><td class="email">abarrera@greenry.eu</td></tr>
    <tr><td>Helios Generación, S. de R.L. de C.V.</td><td class="email">adminhelios@cemex.com</td></tr>
    <tr><td>Horus Solar, S.A. de C.V.</td><td class="email">ever.lara@canadiansolar.com</td></tr>
    <tr><td>Iberdrola Renovables Centro, S.A. de C.V.</td><td class="email">celmercado@iberdrola.com</td></tr>
    <tr><td>Iberdrola Renovables del Bajío, S.A. de C.V.</td><td class="email">sherrera@iberdrola.com</td></tr>
    <tr><td>Iberdrola Renovables Noreste, S.A. de C.V.</td><td class="email">omlecarza@iberdrola.com</td></tr>
    <tr><td>Impulsora Azucarera del Trópico, S.A. de C.V.</td><td class="email">o.meza@qat.com.mx</td></tr>
 
  <tr><td>Infraestructura Energética del Norte, S. de R.L. de C.V.</td><td class="email">asaladie@opde.net</td></tr>
    <tr><td>Ingenio El Mante, S.A. de C.V.</td><td class="email">ramon.alvarez@pantaleon.com</td></tr>
    <tr><td>Ingenio La Margarita, S.A. de C.V.</td><td class="email">auxcoatan@lamargarita.com.mx</td></tr>
    <tr><td>Ingenio San Francisco Ameca, S.A. de C.V.</td><td class="email">rafaelco@sbm.com.mx</td></tr>
    <tr><td>Ingredion México, S.A. de C.V.</td><td class="email">pedro.flores@ingredion.com</td></tr>
    <tr><td>Kenergreen, S.A.P.I. de C.V.</td><td class="email">celsnavojoa@x-elio.com</td></tr>
    <tr><td>La Pimienta Solar, S. de R.L. de C.V.</td><td class="email">valvarez@atlasren.com</td></tr>
    <tr><td>La Trinidad Solar Dos, S.A.P.I. de C.V.</td><td class="email">alexis.castro@nexusenergia.mx</td></tr>
    <tr><td>La Trinidad Solar Uno, S.A.P.I. de C.V.</td><td class="email">alexis.castro@nexusenergia.mx</td></tr>
    <tr><td>Lamosa Energía de Monterrey, S.A. de C.V.</td><td class="email">emorales@iecol.com.mx</td></tr>
    <tr><td>Lesaffre Energías Mexicanas, S.A. de C.V.</td><td class="email">betosino@yahoo.com.mx</td></tr>
    <tr><td>MG HR, S. de R.L. de C.V.</td><td class="email">mexicorenewables@innerveyollc.com</td></tr>
    <tr><td>Mitre Calera Solar, S. de R.L. de C.V.</td><td class="email">liliana.hernandez@mitinfra.com</td></tr>
    <tr><td>NP Energía La Lucha, S.A. de C.V.</td><td class="email">antonio.montes@northlandpower.com</td></tr>
    <tr><td>Operadora Tecnocambiental Sea, S.A. de C.V.</td><td class="email">jcasas.operadoratecnocambiental@gmail.com</td></tr>
    <tr><td>Operadora Tecnocambiental Sea, S.A. de C.V.</td><td class="email">jcasas@vazqueznava.com</td></tr>
    <tr><td>Optimaize, S.A. de C.V.</td><td class="email">armando.ortiz@minsa.com.mx</td></tr>
    <tr><td>Pactiu Foodservice México, S. de R.L. de C.V.</td><td class="email">ariojas@ccn-law.com.mx</td></tr>
    <tr><td>Parque Amistad II, S.A. de C.V.</td><td class="email">luis.hernandez@enel.com</td></tr>
    <tr><td>Parque Amistad III, S.A. de C.V.</td><td class="email">ricardo.cortes@enel.com</td></tr>
    <tr><td>Parque Amistad IV, S.A. de C.V.</td><td class="email">Jorge.Radie@enel.com</td></tr>
    <tr><td>Parque de Tecnología Electrónica, S.A. de C.V.</td><td class="email">carlos.figueroa@flex.com</td></tr>
    <tr><td>Parque de Tecnología Electrónica, S.A. de C.V.</td><td class="email">mx.jrzfacilitiesenergy@flex.com</td></tr>
    <tr><td>Parque Eólico de San Lázaro, S. de R.L. de C.V.</td><td class="email">dimartinez@acciona.com</td></tr>
    <tr><td>Parque Eólico El Mezquite, S.A.P.I. de C.V.</td><td class="email">pe.mezquite@cubicoinvest.com</td></tr>
    <tr><td>Parque Eólico Reynosa III, S.A.P.I. de C.V.</td><td class="email">per3@zumaenergia.com</td></tr>
    <tr><td>Parque Salitrillos, S.A. de C.V.</td><td class="email">mauricio.diaz@enel.com</td></tr>
    <tr><td>Parque Solar Don José, S.A. de C.V.</td><td class="email">allan.amador@enel.com</td></tr>
    <tr><td>Parque Solar Los Cuervos, S. de R.L. de C.V.</td><td class="email">AssetManagement@edpr.com</td></tr>
    <tr><td>Parque Solar Villanueva Tres, S.A. de C.V.</td><td class="email">lidefonso.ramos@enel.com</td></tr>
    <tr><td>Parras Cone de México, S. de R.L. de C.V.</td><td class="email">mariela.gonzalez@burlingtonfabrics.com</td></tr>
    <tr><td>Pasteurizadora Maulec, S.A.P.I. de C.V.</td><td class="email">adrianr@maulec.com.mx</td></tr>
    <tr><td>Photoremis Sustentable, S.A. de C.V.</td><td class="email">jrobles@alterenerusun.com</td></tr>
    <tr><td>Piasa Cogeneración, S.A. de C.V.</td><td class="email">cogeneracion4.itvsa@grupopiasa.com</td></tr>
    <tr><td>PIASA Ingenio Plan de San Luis, S.A. de C.V.</td><td class="email">lmunoz@grupopiasa.com</td></tr>
    <tr><td>Polímeros y Derivados, S.A. de C.V.</td><td class="email">coggenpdysa@gmail.com</td></tr>
    <tr><td>Productora Yoreme, S.P.R. de R.L.</td><td class="email">cmv@yoreme.com</td></tr>
    <tr><td>Rancho El Trece Solar PV, S.A. de C.V.</td><td class="email">flopez@ampmer.com</td></tr>
    <tr><td>Recurrent Energy Mexico Development, S. de R.L. de C.V.</td><td class="email">pablo.sironi@canadiansolar.com</td></tr>
    <tr><td>Recursos Solares de México IV, S.A. de C.V.</td><td class="email">carlos.cabet@engie.com</td></tr>
    <tr><td>Ronal San Luis, S.A. de C.V.</td><td class="email">raymundo.martinez@ronalgroup.com</td></tr>
 
    <tr><td>Sabormex, S.A. de C.V.</td><td class="email">jose.mercado@prodigy.net.mx</td></tr>
    <tr><td>Sky Eps Supply SM, S.A. de C.V.</td><td class="email">gerardo.cordova@skytex.com.mx</td></tr>
    <tr><td>Sol de Insurgentes, S. de R.L. de C.V.</td><td class="email">octavio.dominguez@engie.com</td></tr>
    <tr><td>Solar Park Viborillas, S. de R.L. de C.V.</td><td class="email">daniel.rodriguez@whitesummitcap.com</td></tr>
    <tr><td>Tai Durango Cinco P-10, S.A.P.I. de C.V.</td><td class="email">jav.oliva@eosolenergy.com</td></tr>
    <tr><td>Tai Durango Cinco P-15, S.A.P.I. de C.V.</td><td class="email">jav.oliva2@eosolenergy.com</td></tr>
    <tr><td>Tai Durango Cinco, S.A.P.I. de C.V.</td><td class="email">alexis.castro@nexusenergia.mx</td></tr>
    <tr><td>Tai Durango Cuatro Neo, S.A.P.I. de C.V.</td><td class="email">Jav.Oliva4@eosolenergy.com</td></tr>
    <tr><td>Tai Durango Cuatro, S.A.P.I. de C.V.</td><td class="email">alexis.castro@nexusenergia.mx</td></tr>
    <tr><td>Tai Durango Dos, S.A.P.I. de C.V.</td><td class="email">alexis.castro@nexusenergia.mx</td></tr>
    <tr><td>Tai Durango Seis, S.A.P.I. de C.V.</td><td class="email">alexis.castro@nexusenergia.mx</td></tr>
    <tr><td>Tai Durango Tres, S.A.P.I. de C.V.</td><td class="email">alexis.castro@nexusenergia.mx</td></tr>
    <tr><td>Tampico Renewable Energy, S.A.P.I. de C.V., Central 2</td><td class="email">tramites@tre.com.mx</td></tr>
    <tr><td>Tizayuca Textil Vuva, S.A. de C.V.</td><td class="email">arim.perez@ilusion.com.mx</td></tr>
    <tr><td>Torreoncitos Solar PV, S.A. de C.V.</td><td class="email">ahernandez@ampmer.com</td></tr>
    <tr><td>Tractebel Energía de Monterrey, S. de R.L. de C.V.</td><td class="email">angel.guzman@engie.com</td></tr>
    <tr><td>Tuli Energía, S.A. de R.L. de C.V.</td><td class="email">admintuli@cemex.com</td></tr>
    <tr><td>Tuto Energy II, S.A.P.I. de C.V.</td><td class="email">mnieblac@acciona.es</td></tr>
    <tr><td>Vega Solar 6, S.A.P.I. de C.V.</td><td class="email">aosuna@atlasren.com</td></tr>
    <tr><td>Versalles de las Cuatas Dos, S.A.P.I. de C.V.</td><td class="email">Jav.Oliva4@eosolenergy.com</td></tr>
    <tr><td>Versalles de las Cuatas Tres, S.A.P.I. de C.V.</td><td class="email">Jav.Oliva5@eosolenergy.com</td></tr>
    <tr><td>Versalles de las Cuatas Uno, S.A.P.I. de C.V.</td><td class="email">Jav.Oliva3@eosolenergy.com</td></tr>
    <tr><td>Vientos de Coahuila, S.A de C.V.</td><td class="email">diana.sanchez@edp.com</td></tr>

            </tbody>
        </table>
    </div>

    <br>
   <h2 class="subtitulo mb-3">Suministradores que representan Generación Limpia Distribuida</h2>
    <div class="table-responsive pb-3">
        <table id="tabla-gld" class="display table table-hover table-responsive table-bordered">
            <thead>
                <tr>
                   <th>Suministrador que representa Generación Limpia Distribuida</th>
                    <th>Correo Electrónico</th>
                </tr>
            </thead>
<tbody>
    <tr>
      <td>AMMPER Energía, S.A.P.I. de C.V.</td>
      <td class="email">emorales@ammper.com</td>
    </tr>
    <tr>
      <td>CFE Calificados, S.A. de C.V.</td>
      <td class="email">hector.tellez@calificados.cfe.mx</td>
    </tr>
    <tr>
      <td>COX Energy México Suministrador, S.A. de C.V.</td>
     <td class="email">angie.soto@nexusenergia.mx</td>
    </tr>
    <tr>
      <td>E2M Suministrador Calificado, S.A.P.I. de C.V.</td>
      <td class="email">luis.hoffner@e2m.mx</td>
    </tr>
    <tr>
      <td>Energía Solario, S.A. de C.V.</td>
      <td class="email">carlos@solario.mx</td>
    </tr>
    <tr>
      <td>Integra Potencia Consultoría en Hidrocarburos y Electricidad, S.A. de C.V.</td>
     <td class="email">oguerra@integrapotencia.com</td>
    </tr>
    <tr>
      <td>Renovables Valor Agregado y Resultados Suministradora, S.A.P.I. de C.V.</td>
      <td class="email">gisela.rodriguez@kualion.com</td>
    </tr>
    <tr>
      <td>RIC Energy México, S.A.P.I. de C.V.</td>
      <td class="email">gtorres@ricenergy.mx</td>
    </tr>
    <tr>
      <td>Servicios y Energía México SYEM, S.A.P.I. de C.V.</td>
      <td class="email">francisco.lorencez@engie.com</td>
    </tr>
    <tr>
      <td>Sujio, S.A.P.I. de C.V.</td>
      <td class="email">ouribe@sujio.mx</td>
    </tr>
  </tbody>
        </table>
    </div>

    <br>
    <!-- Título con alert -->
    <div class="alert alert-success text-center" role="alert">
        <h3><i class="bi bi-clock-history me-2"></i>Línea del tiempo de los Certificados de Energías Limpias</h3>
        <hr>
        <p>¡Conoce la línea del tiempo de los Instrumentos Regulatorios que ha emitido la CRE en Materia de Certificados de Energías Limpias!</p>
    </div>

    <!-- Tarjetas de Totales (sin AOS) -->
    <div class="row">
        <div class="col-md-6 mb-4">
            <div class="card" style="background-color: #006769;">
                <div class="card-body text-center">
                    <h4 class="card-title text-white">
                        <i class="bi bi-file-text me-2"></i>Total Resoluciones
                    </h4>
                    <p class="card-text display-4 text-white">@string.Format("{0:N0}", ViewData["TotalResoluciones"])</p>
                </div>
            </div>
        </div>

        <div class="col-md-6 mb-4">
            <div class="card" style="background-color: #006769;">
                <div class="card-body text-center">
                    <h4 class="card-title text-white">
                        <i class="bi bi-files me-2"></i>Total Acuerdos
                    </h4>
                    <p class="card-text display-4 text-white">@string.Format("{0:N0}", ViewData["TotalAcuerdos"])</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Controles Timeline (sin AOS) -->
    <div class="pb-3">
        <button id="zoomIn" class="btn btn-primary">
            <i class="bi bi-zoom-in me-2"></i>Acercar
        </button>
        <button id="zoomOut" class="btn btn-primary">
            <i class="bi bi-zoom-out me-2"></i>Alejar
        </button>
    </div>

    <div id="timeline"></div>
</div>

<script>
    $(document).ready(function () {
        Highcharts.chart('grafico-cel', {
            chart: {
                type: 'bar',  // Gráfico de barras
                backgroundColor: '#efefee'
            },
            title: {
                text: 'Otorgamiento de CEL Histórico'
            },
            xAxis: {
                categories: ['ENERO', 'FEBRERO', 'MARZO', 'ABRIL', 'MAYO', 'JUNIO', 'JULIO', 'AGOSTO', 'SEPTIEMBRE', 'OCTUBRE', 'NOVIEMBRE', 'DICIEMBRE'],
                title: {
                    text: null
                }
            },
            yAxis: {
                min: 0,
                title: {
                    text: 'Otorgamiento de CEL',
                    align: 'high'
                },
                labels: {
                    overflow: 'justify',
                    formatter: function () {
                        return Highcharts.numberFormat(this.value, 0, '.', ',');
                    },
                    style: {
                        fontSize: '10px'  // Tamaño de fuente para los labels del eje Y
                    }
                },
                stackLabels: {
                    enabled: true,
                    style: {
                        fontWeight: 'bold',
                        color: 'black',  // Color del texto del total
                        fontSize: '10px'  // Tamaño de la fuente del total
                    },
                    formatter: function () {
                        // Solo mostrar total si es mayor a 0
                        return this.total > 0 ? Highcharts.numberFormat(this.total, 0, '.', ',') : '';
                    }
                }
            },
            tooltip: {
                valueDecimals: 0,
                formatter: function () {
                    // Solo mostrar el tooltip si hay valor mayor a 0
                    if (this.y > 0) {
                        return '<b>' + this.x + '</b><br/>' +
                            this.series.name + ': ' + Highcharts.numberFormat(this.y, 0, '.', ',') + '<br/>' +
                            'Total: ' + Highcharts.numberFormat(this.point.stackTotal, 0, '.', ',');
                    }
                    return false; // No mostrar tooltip para valores 0
                }
            },
            plotOptions: {
                bar: {
                    stacking: 'normal',
                    dataLabels: {
                        enabled: true,
                        color: 'black',
                        style: {
                            fontSize: '10px',
                            textOutline: '1px contrast'
                        },
                        formatter: function() {
                            // Solo mostrar etiqueta si hay valor
                            return this.y ? Highcharts.numberFormat(this.y, 0, '.', ',') : '';
                        }
                    }
                }
            },
            legend: {
                layout: 'horizontal',
                align: 'center',
                verticalAlign: 'bottom',
                backgroundColor: Highcharts.defaultOptions.legend.backgroundColor || 'white',
                borderColor: '#CCC',
                borderWidth: 1,
                shadow: false
            },
            credits: {
                enabled: false
            },
            colors: ['#D9ED92', '#B5E48C', '#99D98C', '#76C893', '#52B69A', '#34A0A4', '#168AAD'],  // Nueva paleta de colores pastel
            series: [{
                name: '2018',
                data: [538572, 427233, 532939, 549051, 674984, 526698, 1033073, 1000856, 1157196, 880678, 743355, 850942]
            }, {
                name: '2019',
                data: [648446, 669909, 1097669, 1049868, 1231452, 1316380, 1482776, 1472416, 1376814, 1521601, 1335226, 1394589]
            }, {
                name: '2020',
                data: [1530651, 1708950, 2051673, 1999103, 1958300, 1932990, 2152132, 1789495, 1686139, 2040108, 1693438, 1752448]
            }, {
                name: '2021',
                data: [1705445, 1887234, 2611467, 2507151, 2739825, 2303208, 2339402, 2523167, 2169083, 2051384, 2081518, 2126698]
            }, {
                name: '2022',
                data: [1680120, 1812744, 2404781, 2124862, 2412403, 2421500, 2522640, 2230620, 1601547, 1674428, 1730790, 2017990]
            }, {
                name: '2023',
                data: [2165115, 2191107, 2715207, 2509695, 2467700, 2720630, 2800282, 2514207, 2196668, 1947998, 1680727, 1830775]
            }, {
                name: '2024',
                data: [1904200, 2198405, 2323209, 2537756, 2754979, 2637287, 2285926, 2618979, 0, 0, 0, 0] // Cambiamos null por 0
            }]

        });

        // Inicializar DataTable y mostrar todas las filas
        var table_mun = $('#tabla-cel').DataTable({
            lengthMenu: [[-1], ["Todos"]],
            dom: 'Blfrtip',
            buttons: [
                {
                    extend: 'copyHtml5',
                    title: 'Certificados de Energías Limpias - Otorgamiento de CEL Histórico'
                },
                {
                    extend: 'excelHtml5',
                    title: 'Certificados de Energías Limpias - Otorgamiento de CEL Histórico'
                },
                {
                    extend: 'csvHtml5',
                    title: 'Certificados de Energías Limpias - Otorgamiento de CEL Histórico'
                },
                {
                    extend: 'pdfHtml5',
                    title: 'Certificados de Energías Limpias - Otorgamiento de CEL Histórico',
                    customize: function (doc) {
                        doc.styles.tableHeader.color = '#9fa1a4';
                        doc.defaultStyle.alignment = 'center';
                        doc.styles.tableHeader.fillColor = '#4c1922';
                    }
                }
            ],
            language: {
                url: '//cdn.datatables.net/plug-ins/1.10.24/i18n/Spanish.json'
            },
            order: []  // Desactivar el ordenamiento automático
        });

  var table_genl = $('#tabla-genl').DataTable({
    lengthMenu: [[10, 25, 50, -1], [10, 25, 50, "Todos"]],
    dom: 'Blfrtip',
    buttons: [
        {
            extend: 'copyHtml5',
            title: 'Certificados de Energías Limpias - Otorgamiento de CEL Histórico'
        },
        {
            extend: 'excelHtml5',
            title: 'Certificados de Energías Limpias - Otorgamiento de CEL Histórico'
        },
        {
            extend: 'csvHtml5',
            title: 'Certificados de Energías Limpias - Otorgamiento de CEL Histórico'
        },
        {
            extend: 'pdfHtml5',
            title: 'Certificados de Energías Limpias - Otorgamiento de CEL Histórico',
            customize: function (doc) {
                doc.styles.tableHeader.color = '#9fa1a4';
                doc.defaultStyle.alignment = 'center';
                doc.styles.tableHeader.fillColor = '#4c1922';
            }
        }
    ],
    language: {
        url: '//cdn.datatables.net/plug-ins/1.10.24/i18n/Spanish.json'
    },
    order: []  // Desactivar el ordenamiento automático
});
//funcion para el envío de EMail
$('#tabla-genl tbody tr').each(function() {
    var emailCell = $(this).find('td:eq(1)'); // Asumiendo que la columna del correo es la segunda
    var email = emailCell.text().trim();
    if (email) {
        emailCell.html('<a href="mailto:' + email + '">' + email + '</a>');
    }
});
//funcion para el envío de EMail
$('#tabla-gld tbody tr').each(function() {
    var emailCell = $(this).find('td:eq(1)'); // Asumiendo que la columna del correo es la segunda
    var email = emailCell.text().trim();
    if (email) {
        emailCell.html('<a href="mailto:' + email + '">' + email + '</a>');
    }
});
   });
</script>

<!-- Agregar Vis.js desde CDN -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/vis/4.21.0/vis.min.css" rel="stylesheet" type="text/css" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/vis/4.21.0/vis.min.js"></script>
<script type="text/javascript">
    var container = document.getElementById('timeline');

    // Crear los items de la línea del tiempo usando los datos pasados desde el modelo
    var items = new vis.DataSet([
    @foreach (var item in Model)
    {
        <text>
                {
                    id: @item.Id,
                content: '<div style="cursor:pointer; width: 150px; word-wrap: break-word; font-size: 12px;">@item.Tipo<br>@item.Numero<br><small>@item.Fecha.ToString("dd/MM/yyyy")</small><br><a class="btn btn-primary btn-sm" onclick="event.stopPropagation(); window.open(\'@item.Link\', \'_blank\'); return false;">Ver detalle</a></div>',
                    start: '@item.Fecha.ToString("yyyy-MM-dd")',
                    link: '@item.Link',  // Enlace
                                                // Comentamos o eliminamos el tooltip (title)
                                                // title: '@item.Proemio' // Tooltip
                                            },
        </text>
    }
                ]);

                // Obtener la fecha actual
                var today = new Date();

                // Configuración de la línea del tiempo con apilamiento activado y opciones de zoom
                var options = {
                    editable: false,
                height: '400px',  // Fijar la altura de la línea del tiempo
                maxHeight: '400px',  // Fijar la altura máxima
                stack: true,  // Permitir apilamiento vertical de las cajas
                margin: {item: 20 },  // Margen entre las cajas
                horizontalScroll: true,  // Permitir desplazamiento horizontal si es necesario
                start: '2016-01-01',  // Inicio de la línea del tiempo en 2016
                end: today,  // Fin de la línea del tiempo en la fecha actual
                zoomMin: 100000000,  // Ajustar el zoom mínimo
                zoomMax: 100000000000,  // Ajustar el zoom máximo
                zoomKey: 'ctrlKey',  // Permitir zoom con la tecla Ctrl y scroll del mouse
    };

                // Inicializar la línea del tiempo
                var timeline = new vis.Timeline(container, items, options);

                // Agregar botones de zoom in y zoom out
                function zoomIn() {
        var range = timeline.getWindow();
                var interval = range.end - range.start;
                timeline.setWindow({
                    start: range.start.valueOf(),
                end: range.start.valueOf() + interval * 0.8  // Hacer zoom in (20% más cerca)
        });
    }

                function zoomOut() {
        var range = timeline.getWindow();
                var interval = range.end - range.start;
                timeline.setWindow({
                    start: range.start.valueOf(),
                end: range.start.valueOf() + interval * 1.25  // Hacer zoom out (25% más lejos)
        });
    }

                // Agregar eventos para hacer clic en botones de zoom
                document.getElementById('zoomIn').onclick = zoomIn;
                document.getElementById('zoomOut').onclick = zoomOut;

                // Prevenir cualquier acción al hacer clic en la caja entera
                timeline.on('click', function (properties) {
        var item = items.get(properties.item);
        // No hacemos nada al hacer clic en la caja
    });

    // No necesitamos el tooltipStyle ya que no se usará
</script>
