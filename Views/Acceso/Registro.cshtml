@{
    ViewData["Title"] = "Registro al Sistema Nacional de Información Energética";
    Layout = null;
}

<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <title>SNIE - Registro de Usuario</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="https://unpkg.com/aos@2.3.4/dist/aos.css" rel="stylesheet">

    <style>
        body,
        html {
            height: 100%;
            margin: 0;
            overflow-x: hidden;
            font-family: 'Segoe UI', sans-serif;
        }

        video#myVideo {
            position: fixed;
            right: 0;
            bottom: 0;
            min-width: 100%;
            min-height: 100%;
            z-index: -1;
        }

        .form-container {
            background-color: rgba(255, 255, 255, 0.8);
            backdrop-filter: blur(8px);
            padding: 2rem;
            border-radius: 15px;
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.2);
            max-width: 700px;
            margin: 60px auto;
        }

        .btn-custom {
            background-color: #81c3c9;
            color: white;
        }

        .btn-custom:hover {
            background-color: #6ba9af;
        }

        .step-title {
            font-weight: 600;
            font-size: 1.2rem;
            margin-bottom: 1rem;
            color: #1c4c63;
        }

        .barra-carga {
            height: 16px;
            background-color: #ddd;
            border-radius: 4px;
            overflow: hidden;
            margin-bottom: 10px;
        }

        .barra-carga .progreso {
            height: 100%;
            width: 0%;
            background-color: #81c3c9;
            transition: width 1s ease-in-out;
        }

        .oculto {
            display: none;
        }
    </style>
</head>

<body>
    <video autoplay muted loop id="myVideo">
        <source src="/video/Login_n.mp4" type="video/mp4">
    </video>

    <div class="container">
        <div class="form-container" data-aos="fade-up">
            <div class="text-center mb-4">
                <img src="/img/lc6.png" height="90">
                <h2 class="mt-2" style="color:#1c4c63">Registro de Usuario</h2>
            </div>

            <form id="registroForm">
                <!-- Paso 1 -->
                <div id="paso1">
                    <p class="step-title">Paso 1: Cargar Constancia de Situación Fiscal</p>
                    <input type="file" id="constanciaFile" class="form-control mb-2" required>
                    <small class="text-muted">Solo PDF (máx 5MB)</small>
                    <div class="barra-carga mt-2">
                        <div class="progreso" id="barraProgreso"></div>
                    </div>
                    <div id="datosFiscales" class="alert alert-info mt-3 oculto">
                        <strong>RFC:</strong> SACJ820506BC5<br>
                        <strong>CURP:</strong> SACJ820506HDFSLV02<br>
                        <strong>Nombre:</strong> Javier Sasso Celaya<br>
                        <strong>Domicilio:</strong> La Quemada 3915, Dpto 304<br>
                        <strong>CP:</strong> 03000<br>
                        <strong>Régimen:</strong> Sueldos y Salarios
                    </div>
                    <div class="text-end mt-3">
                        <button type="button" id="btnPaso1" class="btn btn-custom">Continuar</button>
                    </div>
                </div>

                <!-- Paso 2 -->
                <div id="paso2" class="oculto">
                    <p class="step-title">Paso 2: Subir Certificados</p>
                    <input type="file" id="certCer" class="form-control mb-2" required>
                    <input type="file" id="certKey" class="form-control mb-2" required>
                    <input type="password" id="certPass" class="form-control mb-2"
                        placeholder="Contraseña del Certificado" required>
                    <div class="text-end">
                        <button type="button" id="btnPaso2" class="btn btn-custom">Siguiente</button>
                    </div>
                </div>

                <!-- Paso 3 -->
                <div id="paso3" class="oculto">
                    <p class="step-title">Paso 3: Datos de Contacto</p>
                    <input type="email" id="email" class="form-control mb-2" placeholder="Correo electrónico" required>
                    <input type="tel" id="telefono" class="form-control mb-2" value="+52" required>
                    <input type="password" id="pass" class="form-control mb-2" placeholder="Contraseña" required>
                    <input type="password" id="confPass" class="form-control mb-2" placeholder="Confirmar contraseña"
                        required>
                    <div class="text-end">
                        <button type="submit" class="btn btn-success">Finalizar Registro</button>
                    </div>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal Exito -->
    <div class="modal fade" id="modalExito" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title text-success">Registro Exitoso</h5>
                </div>
                <div class="modal-body">
                    <p>Tu registro fue exitoso. Hemos enviado un correo de confirmación.</p>
                </div>
                <div class="modal-footer">
                    <a href="/Acceso/Login" class="btn btn-primary">Ir al Login</a>
                </div>
            </div>
        </div>
    </div>

    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://unpkg.com/aos@2.3.4/dist/aos.js"></script>
    <script>
        AOS.init();

        $('#constanciaFile').on('change', function () {
            const file = this.files[0];
            if (!file || file.size > 5 * 1024 * 1024 || file.type !== 'application/pdf') {
                alert('Archivo inválido. Debe ser PDF menor a 5MB.');
                return;
            }
            $('#barraProgreso').css('width', '0%');
            setTimeout(() => {
                $('#barraProgreso').css('width', '100%');
                setTimeout(() => {
                    $('#datosFiscales').removeClass('oculto');
                }, 500);
            }, 1000);
        });

        $('#btnPaso1').click(function () {
            if (!$('#datosFiscales').hasClass('oculto')) {
                $('#paso1').hide();
                $('#paso2').removeClass('oculto');
            } else {
                alert('Primero debes cargar la constancia correctamente.');
            }
        });

        $('#btnPaso2').click(function () {
            if ($('#certCer').val() && $('#certKey').val() && $('#certPass').val()) {
                $('#paso2').hide();
                $('#paso3').removeClass('oculto');
            } else {
                alert('Debes subir los certificados y contraseña.');
            }
        });

        $('#registroForm').submit(function (e) {
            e.preventDefault();
            if ($('#pass').val() !== $('#confPass').val()) {
                alert('Las contraseñas no coinciden.');
                return;
            }
            $('#modalExito').modal('show');
        });
    </script>
</body>

</html>
