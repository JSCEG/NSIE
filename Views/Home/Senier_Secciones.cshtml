@model HomeIndex
@using NSIE.Models
@using Microsoft.AspNetCore.Http
@using Newtonsoft.Json
@inject IHttpContextAccessor HttpContextAccessor

@{
    ViewData["Title"] = "Tabla Detallada de Secciones y M贸dulos - SNIEr";
    var perfilJson = HttpContextAccessor.HttpContext.Session.GetString("PerfilUsuario");
    var perfilUsuario = JsonConvert.DeserializeObject<PerfilUsuario>(perfilJson);
}

<div class="container-fluid">
    <h2 class="text-center mb-4"> Tabla Detallada por Secci贸n y M贸dulo - SNIEr</h2>

    <div class="table-responsive">
        <table class="table table-bordered table-hover">
            <thead class="thead-dark">
                <tr>
                    <th>Secci贸n</th>
                    <th>M贸dulo</th>
                    <th>Fundamento Legal</th>
                    <th>Roles que Interact煤an</th>
                    <th>Etapa</th>
                    <th>Justificaci贸n del Orden</th>
                    <th>Ayuda Contextual</th>
                </tr>
            </thead>
            <tbody>
                <!-- 1. Gobernanza y Seguridad -->
                <tr>
                    <td rowspan="3"> Gobernanza y Seguridad<br>(Art. 70, 71, 76)</td>
                    <td>Gesti贸n de Usuarios y Perfiles</td>
                    <td>Art. 70 RLPT</td>
                    <td>Administrador (1)</td>
                    <td>Configuraci贸n inicial</td>
                    <td>Base para establecer accesos y permisos del sistema</td>
                    <td>Administra perfiles, roles y accesos seg煤n normativa</td>
                </tr>
                <tr>
                    <td>Seguridad y Auditor铆a</td>
                    <td>Art. 71 RLPT</td>
                    <td>Administrador (1), Consejo (7)</td>
                    <td>Monitoreo continuo</td>
                    <td>Garantiza trazabilidad y seguridad de operaciones</td>
                    <td>Supervisa acciones del sistema y alertas de seguridad</td>
                </tr>
                <tr>
                    <td>Subsistemas Externos Integrados</td>
                    <td>Art. 69 RLPT</td>
                    <td>Administrador (1), Consejo (7), Sectorizado (8)</td>
                    <td>Integraci贸n</td>
                    <td>Permite incorporaci贸n de entidades federativas y municipios</td>
                    <td>Consulta integraci贸n de entidades externas al SNIEr</td>
                </tr>

                <!-- 2. Carga, Validaci贸n y CRM -->
                <tr>
                    <td rowspan="3">Ь Carga, Validaci贸n y CRM<br>(Art. 70, 71, 73, 76)</td>
                    <td>Carga de Informaci贸n</td>
                    <td>Art. 70 RLPT</td>
                    <td>Administrador (1), Sectorizado (8)</td>
                    <td>Captura</td>
                    <td>Punto inicial para registro de datos energ茅ticos</td>
                    <td>Permite carga masiva de informaci贸n sectorial</td>
                </tr>
                <tr>
                    <td>Validaci贸n y Firma</td>
                    <td>Art. 71 RLPT</td>
                    <td>Administrador (1), Sectorizado (8)</td>
                    <td>Validaci贸n</td>
                    <td>Garantiza autenticidad de datos con e.firma</td>
                    <td>Valida registros y genera acuse con firma electr贸nica</td>
                </tr>
                <tr>
                    <td>Notificaciones y Oficios</td>
                    <td>Art. 73 RLPT</td>
                    <td>Administrador (1), Consejo (7), Sectorizado (8)</td>
                    <td>Comunicaci贸n</td>
                    <td>Establece canal oficial de notificaciones</td>
                    <td>Gestiona comunicaci贸n interna y acuses de recibo</td>
                </tr>

                <!-- 3. Datos P煤blicos -->
                <tr>
                    <td rowspan="6"> Datos P煤blicos<br>(Art. 70, 76, 77, 111)</td>
                    <td>Bolet铆n de CELs</td>
                    <td>Art. 70-II-b RLPT</td>
                    <td>Todos (0,1,7,8)</td>
                    <td>Difusi贸n</td>
                    <td>Informaci贸n clave sobre certificados de energ铆as limpias</td>
                    <td>Consulta reportes p煤blicos sobre CELs</td>
                </tr>
                <tr>
                    <td>Balance Nacional de Energ铆a</td>
                    <td>Art. 70-II-a RLPT</td>
                    <td>Todos (0,1,7,8)</td>
                    <td>An谩lisis</td>
                    <td>Visualizaci贸n oficial del flujo energ茅tico nacional</td>
                    <td>Diagrama Sankey del balance energ茅tico</td>
                </tr>
                <tr>
                    <td>Cat谩logo de Tecnolog铆as</td>
                    <td>Art. 70-V RLPT</td>
                    <td>Todos (0,1,7,8)</td>
                    <td>Consulta</td>
                    <td>Base t茅cnica para decisiones de generaci贸n</td>
                    <td>Par谩metros t茅cnicos y econ贸micos de tecnolog铆as</td>
                </tr>
                <tr>
                    <td>Equipos y Aparatos Energ茅ticos</td>
                    <td>Art. 70-IV RLPT</td>
                    <td>Todos (0,1,7,8)</td>
                    <td>Consulta</td>
                    <td>Informaci贸n sobre consumo de equipos relevantes</td>
                    <td>Datos de consumo energ茅tico de equipos</td>
                </tr>
                <tr>
                    <td>Mercado El茅ctrico Mayorista</td>
                    <td>Art. 70-II-b RLPT</td>
                    <td>Administrador (1), Consejo (7), Sectorizado (8)</td>
                    <td>Monitoreo</td>
                    <td>Informaci贸n clave del mercado de corto plazo</td>
                    <td>Consulta desempe帽o del mercado mayorista</td>
                </tr>
                <tr>
                    <td>Precios de Estaciones</td>
                    <td>Art. 77 RLPT</td>
                    <td>Todos (0,1,7,8)</td>
                    <td>Transparencia</td>
                    <td>Datos oficiales de precios por zona</td>
                    <td>Consulta precios actualizados de combustibles</td>
                </tr>

                <!-- 10. Programa del Consejo -->
                <tr>
                    <td rowspan="13"> Programa del Consejo<br>(Art. 76)</td>
                    <td>Programa de Trabajo del Consejo</td>
                    <td>Art. 76 RLPT; Art. 10 Lineamientos</td>
                    <td>Administrador (1), Consejo (7)</td>
                    <td>Planeaci贸n</td>
                    <td>Establece metas y actividades anuales del Consejo</td>
                    <td>Consulta objetivos y recursos del Programa Anual</td>
                </tr>
                <tr>
                    <td>Avance de Metas y L铆neas de Acci贸n</td>
                    <td>Art. 76 RLPT; Art. 45 Lineamientos</td>
                    <td>Administrador (1), Consejo (7)</td>
                    <td>Seguimiento</td>
                    <td>Monitorea cumplimiento del Programa Anual</td>
                    <td>Visualiza avance de metas con KPIs y sem谩foros</td>
                </tr>
                <tr>
                    <td>Orden del D铆a y Convocatorias</td>
                    <td>Art. 76 RLPT; Art. 14-17 Lineamientos</td>
                    <td>Administrador (1), Consejo (7)</td>
                    <td>Preparaci贸n</td>
                    <td>Define agenda y estructura de cada sesi贸n</td>
                    <td>Consulta convocatorias y documentos de sesiones</td>
                </tr>
                <tr>
                    <td>Votaciones Colegiadas</td>
                    <td>Art. 76 RLPT; Art. 32 Lineamientos</td>
                    <td>Administrador (1), Consejo (7)</td>
                    <td>Deliberaci贸n</td>
                    <td>Permite votaci贸n digital sobre puntos en agenda</td>
                    <td>Interfaz para votaci贸n colegiada con qu贸rum</td>
                </tr>
                <tr>
                    <td>Firma de Actas del Consejo</td>
                    <td>Art. 76 RLPT; Art. 30 Lineamientos</td>
                    <td>Administrador (1), Consejo (7)</td>
                    <td>Formalizaci贸n</td>
                    <td>Da validez jur铆dica a acuerdos con e.firma</td>
                    <td>Firma digital de actas y acuerdos</td>
                </tr>
                <tr>
                    <td>Acuerdos de Coordinaci贸n</td>
                    <td>Art. 71 y 76 RLPT; Art. 28-34 Lineamientos</td>
                    <td>Administrador (1), Consejo (7)</td>
                    <td>Seguimiento</td>
                    <td>Centraliza acuerdos formales del Consejo</td>
                    <td>Consulta estatus de cumplimiento de acuerdos</td>
                </tr>
                <tr>
                    <td>Buz贸n de Asuntos del Consejo</td>
                    <td>Art. 76 RLPT; Art. 21-25 Lineamientos</td>
                    <td>Administrador (1), Consejo (7)</td>
                    <td>Registro</td>
                    <td>Punto de entrada para nuevos temas a tratar</td>
                    <td>Registro de propuestas de asuntos para sesiones</td>
                </tr>
                <tr>
                    <td>Indicadores del Consejo</td>
                    <td>Art. 76 RLPT; Art. 45 y 47 Lineamientos</td>
                    <td>Administrador (1), Consejo (7)</td>
                    <td>Evaluaci贸n</td>
                    <td>Mide desempe帽o colegiado con m茅tricas</td>
                    <td>Dashboard con indicadores clave de gesti贸n</td>
                </tr>
                <tr>
                    <td>Trazabilidad de Acuerdos</td>
                    <td>Art. 76 RLPT; Art. 21-33 Lineamientos</td>
                    <td>Administrador (1), Consejo (7)</td>
                    <td>Trazabilidad</td>
                    <td>Seguimiento completo del ciclo de cada tema</td>
                    <td>L铆nea de tiempo de cada asunto deliberado</td>
                </tr>
                <tr>
                    <td>Repositorio de Sesiones</td>
                    <td>Art. 30-31 Lineamientos</td>
                    <td>Administrador (1), Consejo (7)</td>
                    <td>Consulta</td>
                    <td>Archivo hist贸rico de sesiones anteriores</td>
                    <td>Acceso a actas y documentos de sesiones pasadas</td>
                </tr>
                <tr>
                    <td>Consultas P煤blicas</td>
                    <td>Art. 77 RLPT</td>
                    <td>Administrador (1), Consejo (7)</td>
                    <td>Transparencia</td>
                    <td>Difusi贸n de acuerdos y votaciones p煤blicas</td>
                    <td>Visualiza informaci贸n de acceso p煤blico</td>
                </tr>
                <tr>
                    <td>Integrantes y Roles</td>
                    <td>Art. 11-13 Lineamientos</td>
                    <td>Administrador (1), Consejo (7)</td>
                    <td>Estructura</td>
                    <td>Identifica participantes y sus facultades</td>
                    <td>Consulta composici贸n del Consejo</td>
                </tr>
                <tr>
                    <td>Asesor铆a T茅cnica y Documentaci贸n</td>
                    <td>Art. 18 Lineamientos</td>
                    <td>Administrador (1), Consejo (7)</td>
                    <td>Apoyo</td>
                    <td>Provee insumos t茅cnicos para decisiones</td>
                    <td>Acceso a documentos de apoyo y an谩lisis</td>
                </tr>
            </tbody>
        </table>
    </div>
</div>

<style>
    .table {
        font-size: 0.9rem;
    }

    .table thead th {
        position: sticky;
        top: 0;
        background-color: #343a40;
        color: white;
        vertical-align: middle;
    }

    .table td,
    .table th {
        vertical-align: middle;
    }

    td[rowspan] {
        vertical-align: top;
        font-weight: bold;
        background-color: #f8f9fa;
    }

    .table-hover tbody tr:hover {
        background-color: rgba(0, 0, 0, .03);
    }
</style>